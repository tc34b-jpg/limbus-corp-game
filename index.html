<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ManoBit Company: Squad Selection</title>
    <style>
        :root {
            --blood: #660000;
            --gold: #c5a059;
            --bg: #0d0d0d;
            --panel: #1a1a1a;
        }

        body {
            margin: 0; background: var(--bg); color: #e0e0e0;
            font-family: 'Segoe UI', sans-serif; text-transform: uppercase;
        }

        .screen { display: none; height: 100vh; flex-direction: column; align-items: center; justify-content: center; }
        .active { display: flex; }

        /* GRID DE PERSONAGENS */
        .char-container {
            display: grid; grid-template-columns: repeat(6, 1fr);
            gap: 10px; max-width: 900px; margin: 20px;
        }

        .char-card {
            background: var(--panel); border: 1px solid #333;
            padding: 10px; text-align: center; cursor: pointer;
            transition: 0.2s; position: relative; font-size: 0.7rem;
        }

        .char-card:hover { border-color: var(--gold); background: #252525; }
        .char-card.selected { border: 2px solid var(--gold); box-shadow: 0 0 10px var(--gold); }
        .char-card.selected::after { content: "âœ“"; position: absolute; top: 2px; right: 5px; color: var(--gold); font-size: 1rem; }

        /* BATALHA */
        .battle-layout { display: flex; width: 90%; justify-content: space-around; align-items: flex-end; }
        .squad-side, .enemy-side { display: flex; gap: 15px; }
        .unit { text-align: center; width: 100px; }
        .hp-bar { width: 100%; height: 6px; background: #333; margin-top: 5px; border: 1px solid #000; }
        .hp-fill { height: 100%; background: #2ecc71; transition: 0.4s; }
        .enemy-hp { background: var(--blood); }

        #log {
            width: 80%; height: 120px; background: rgba(0,0,0,0.9);
            border: 1px solid var(--gold); margin-top: 20px;
            padding: 10px; overflow-y: auto; font-family: monospace; font-size: 0.8rem;
        }

        button {
            background: black; border: 1px solid var(--gold); color: var(--gold);
            padding: 10px 20px; cursor: pointer; font-weight: bold; margin-top: 10px;
        }
        button:disabled { border-color: #444; color: #444; }
    </style>
</head>
<body>

    <div id="lobby" class="screen active">
        <h1 style="letter-spacing: 10px;">L I M B U S <span style="color: var(--blood);">B I T</span></h1>
        <button onclick="goToSelect()">START DRIVE</button>
    </div>

    <div id="select" class="screen">
        <h2>Selecione 3 Pecadores (<span id="count">0</span>/3)</h2>
        <div class="char-container" id="char-grid"></div>
        <button id="btn-battle" disabled onclick="startBattle()">DEPLOY SQUAD</button>
    </div>

    <div id="battle" class="screen">
        <div class="battle-layout">
            <div class="squad-side" id="player-squad"></div>
            <div style="font-size: 1.5rem; padding-bottom: 20px;">VS</div>
            <div class="enemy-side">
                <div class="unit">
                    <div style="font-size: 2rem;">ðŸ‘¹</div>
                    <div>ABNORMALITY</div>
                    <div class="hp-bar"><div id="e-hp" class="hp-fill enemy-hp" style="width: 100%;"></div></div>
                </div>
            </div>
        </div>
        <div id="log"></div>
        <button id="atk-btn" onclick="executeTurn()">CHAIN ATTACK</button>
    </div>

    <script>
        const sinnersData = [
            { id: 1, name: "Yi Sang", hp: 100, atk: 15 }, { id: 2, name: "Faust", hp: 110, atk: 18 },
            { id: 3, name: "Don Quixote", hp: 95, atk: 22 }, { id: 4, name: "Ryoshu", hp: 90, atk: 25 },
            { id: 5, name: "Meursault", hp: 150, atk: 10 }, { id: 6, name: "Hong Lu", hp: 105, atk: 17 },
            { id: 7, name: "Heathcliff", hp: 120, atk: 20 }, { id: 8, name: "Ishmael", hp: 115, atk: 19 },
            { id: 9, name: "Rodion", hp: 125, atk: 18 }, { id: 10, name: "Dante", hp: 100, atk: 12 },
            { id: 11, name: "Outis", hp: 110, atk: 21 }, { id: 12, name: "Gregor", hp: 130, atk: 16 }
        ];

        let selectedSinners = [];
        let enemy = { name: "Anormalidade", hp: 500, maxHp: 500, atk: 25 };

        // Inicializar Grid
        function goToSelect() {
            const grid = document.getElementById('char-grid');
            grid.innerHTML = '';
            sinnersData.forEach(s => {
                const card = document.createElement('div');
                card.className = 'char-card';
                card.innerHTML = `<strong>${s.name}</strong><br>HP:${s.hp} ATK:${s.atk}`;
                card.onclick = () => toggleSinner(s, card);
                grid.appendChild(card);
            });
            changeScreen('select');
        }

        function toggleSinner(sinner, element) {
            const index = selectedSinners.findIndex(s => s.id === sinner.id);
            if (index > -1) {
                selectedSinners.splice(index, 1);
                element.classList.remove('selected');
            } else if (selectedSinners.length < 3) {
                selectedSinners.push({...sinner, currentHp: sinner.hp});
                element.classList.add('selected');
            }
            document.getElementById('count').innerText = selectedSinners.length;
            document.getElementById('btn-battle').disabled = selectedSinners.length !== 3;
        }

        function startBattle() {
            const squadDiv = document.getElementById('player-squad');
            squadDiv.innerHTML = '';
            selectedSinners.forEach((s, i) => {
                squadDiv.innerHTML += `
                    <div class="unit" id="unit-${i}">
                        <div style="font-size: 1.5rem;">ðŸ‘¤</div>
                        <div>${s.name}</div>
                        <div class="hp-bar"><div id="hp-${i}" class="hp-fill" style="width: 100%;"></div></div>
                    </div>`;
            });
            changeScreen('battle');
            addLog("Iniciando protocolo de combate...");
        }

        function executeTurn() {
            document.getElementById('atk-btn').disabled = true;
            
            // Ataque dos Pecadores
            selectedSinners.forEach((s, i) => {
                if(s.currentHp > 0 && enemy.hp > 0) {
                    setTimeout(() => {
                        let dmg = Math.floor(Math.random() * s.atk) + 5;
                        enemy.hp -= dmg;
                        addLog(`${s.name} atacou e causou ${dmg} de dano!`);
                        updateUI();
                    }, i * 500);
                }
            });

            // Ataque do Inimigo
            setTimeout(() => {
                if(enemy.hp > 0) {
                    let targetIdx = Math.floor(Math.random() * selectedSinners.length);
                    let target = selectedSinners[targetIdx];
                    if(target.currentHp > 0) {
                        let eDmg = enemy.atk + Math.floor(Math.random() * 10);
                        target.currentHp -= eDmg;
                        if(target.currentHp < 0) target.currentHp = 0;
                        addLog(`<span style="color:var(--blood)">Inimigo esmagou ${target.name} com ${eDmg} de dano!</span>`);
                        updateUI();
                    }
                } else {
                    addLog("--- VITÃ“RIA! A ANORMALIDADE FOI CONTIDA ---");
                }
                document.getElementById('atk-btn').disabled = false;
            }, 2000);
        }

        function updateUI() {
            document.getElementById('e-hp').style.width = (enemy.hp / enemy.maxHp * 100) + "%";
            selectedSinners.forEach((s, i) => {
                document.getElementById(`hp-${i}`).style.width = (s.currentHp / s.hp * 100) + "%";
                if(s.currentHp <= 0) document.getElementById(`unit-${i}`).style.opacity = "0.4";
            });
        }

        function addLog(m) {
            const l = document.getElementById('log');
            l.innerHTML += `> ${m}<br>`;
            l.scrollTop = l.scrollHeight;
        }

        function changeScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }
    </script>
</body>
</html>
